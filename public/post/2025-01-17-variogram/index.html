<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Understanding Variogram in Geospatial Analysis | Ankit&#39;s Hydro-Geo Insights</title>
<meta name="keywords" content="R, Geospatial">
<meta name="description" content="IntroductionGeospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the variogram. In this article, we will explore what a variogram is, how it is used in Kriging, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.
A Note on Spatial RelationshipsThe First Law of Geography, proposed by Waldo Tobler, states:">
<meta name="author" content="Dr. Ankit Deshmukh">
<link rel="canonical" href="https://ankitdeshmukh.com/post/2025-01-17-variogram/">
<meta name="google-site-verification" content="G-R5FJKDQD1M">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ankitdeshmukh.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ankitdeshmukh.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ankitdeshmukh.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ankitdeshmukh.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://ankitdeshmukh.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
<link rel="stylesheet" href="/fonts/font-family.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-R5FJKDQD1M"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-R5FJKDQD1M', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Understanding Variogram in Geospatial Analysis" />
<meta property="og:description" content="IntroductionGeospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the variogram. In this article, we will explore what a variogram is, how it is used in Kriging, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.
A Note on Spatial RelationshipsThe First Law of Geography, proposed by Waldo Tobler, states:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ankitdeshmukh.com/post/2025-01-17-variogram/" />
<meta property="og:image" content="https://ankitdeshmukh.com/Cover.jpg" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2025-01-17T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2025-01-17T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://ankitdeshmukh.com/Cover.jpg" />
<meta name="twitter:title" content="Understanding Variogram in Geospatial Analysis"/>
<meta name="twitter:description" content="IntroductionGeospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the variogram. In this article, we will explore what a variogram is, how it is used in Kriging, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.
A Note on Spatial RelationshipsThe First Law of Geography, proposed by Waldo Tobler, states:"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ankitdeshmukh.com/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Understanding Variogram in Geospatial Analysis",
      "item": "https://ankitdeshmukh.com/post/2025-01-17-variogram/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Understanding Variogram in Geospatial Analysis",
  "name": "Understanding Variogram in Geospatial Analysis",
  "description": "Introduction\rGeospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the variogram. In this article, we will explore what a variogram is, how it is used in Kriging, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.\nA Note on Spatial Relationships\rThe First Law of Geography, proposed by Waldo Tobler, states:",
  "keywords": [
    "R", "Geospatial"
  ],
  "articleBody": "\rIntroduction\rGeospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the variogram. In this article, we will explore what a variogram is, how it is used in Kriging, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.\nA Note on Spatial Relationships\rThe First Law of Geography, proposed by Waldo Tobler, states:\n“Everything is related to everything else, but near things are more related than distant things.”\nThis principle forms the backbone of variogram analysis and Kriging.\nWhat is a Variogram?\rA variogram is a graphical representation or function that quantifies the spatial autocorrelation of a dataset. It demonstrates how similarity between measurements decreases with increasing distance.\nKey Components of a Variogram\rLag Distance (h): The separation distance between data points.\rSemivariance (γ(h)): A measure of the dissimilarity between data points separated by distance h.\rSill: The semivariance value where the variogram levels off, representing the data’s overall variance.\rRange: The distance at which the variogram reaches the sill, indicating the limit of spatial correlation.\rNugget: The y-intercept of the variogram, accounting for measurement errors or microscale variations.\rVariogram Models\rVariogram models are mathematical functions used to fit experimental variograms. These models capture the spatial dependence of the data and are essential for Kriging. Commonly used models include:\nSpherical Model:\rFormula:\r\\[\r\\gamma(h) =\r\\begin{cases}\rC_0 + C \\left[\\frac{3h}{2a} - \\frac{h^3}{2a^3}\\right], \u0026 0 \\leq h \\leq a \\\\\rC_0 + C, \u0026 h \u003e a\r\\end{cases}\r\\]\rCharacteristics:\rCommonly used in geosciences.\rLevels off at the range (a).\rRepresents a gradual transition of spatial correlation.\rExponential Model:\rFormula:\r\\[\r\\gamma(h) = C_0 + C \\left(1 - e^{-h/a}\\right)\r\\]\rCharacteristics:\rSuitable for phenomena with continuous but less abrupt changes.\rCorrelation decreases exponentially with distance.\rGaussian Model:\rFormula:\r\\[\r\\gamma(h) = C_0 + C \\left(1 - e^{-\\left(\\frac{h}{a}\\right)^2}\\right)\r\\]\rCharacteristics:\rSmooth transitions, often used in environmental studies.\rEffective for data with strong local correlations.\rLinear Model:\rFormula:\r\\[\r\\gamma(h) = C_0 + C h\r\\]\rCharacteristics:\rRepresents a direct, proportional increase in semivariance with distance.\rSimplistic but useful for certain datasets.\rPower Model:\rFormula:\r\\[\r\\gamma(h) = C_0 + C h^k, \\quad 0 \u003c k \u003c 2\r\\]\rCharacteristics:\rFlexible model for datasets with non-linear spatial relationships.\rEach model serves specific purposes based on the dataset and the spatial behavior being analyzed. Selecting the appropriate variogram model is crucial for accurate Kriging.\nThe summary of selecting a variogram model presented below:\nCondition\rRecommended Model\rSharp cutoff in spatial correlation\rSpherical (Sph)\rRapid decay of correlation\rExponential (Exp)\rSmooth transitions over space\rGaussian (Gau)\rFlexible/Intermediate behavior\rMatérn (Mat)\rShort-range dominance\rExponential or Matérn\rLong-range dominance\rSpherical or Gaussian\rUncertainty about smoothness\rMatérn (adjust \\(\\nu\\))\rComputing the Variogram in R\rHere, we demonstrate how to compute an experimental variogram and fit a theoretical model using hypothetical borehole data.\n# Generate hypothetical borehole data\rset.seed(123)\rlocation \u003c- data.frame(\rx = runif(20, 0, 100),\ry = runif(20, 0, 100)\r)\rlocation$water_level \u003c- 50 + rnorm(20, mean = 0, sd = 5)\r# View the data\rhead(location)\r## x y water_level\r## 1 28.75775 88.95393 44.66088\r## 2 78.83051 69.28034 48.91013\r## 3 40.89769 64.05068 44.86998\r## 4 88.30174 99.42698 46.35554\r## 5 94.04673 65.57058 46.87480\r## 6 4.55565 70.85305 41.56653\rExperimental Variogram\rif (!require(sp)) { install.packages('sp'); library(sp)}\rif (!require(gstat)) { install.packages('gstat'); library(gstat)}\r# Convert to spatial object\rcoordinates(location) \u003c- ~x + y\r# Compute experimental variogram\rvariogram_exp \u003c- variogram(water_level ~ 1, location)\rhead(variogram_exp)\r## np dist gamma dir.hor dir.ver id\r## 1 2 7.912548 12.129825 0 0 var1\r## 2 2 11.366795 9.534399 0 0 var1\r## 3 2 14.046246 17.299652 0 0 var1\r## 4 6 15.922439 23.613955 0 0 var1\r## 5 4 19.786952 31.321265 0 0 var1\r## 6 5 22.195585 18.261615 0 0 var1\rThe formula used above have format independent_variable ~ 1 or independent_variable ~ x+y. X or/and Y, any independent variables or covariates (if applicable). If the formula is ~ 1, it means there are no covariates, and the variogram will be calculated solely based on spatial relationships. The output of variogram_exp is has field such as np, dist, gamma etc…\nnp: the number of point pairs for this estimate; in case of a variogramCloud see below\rdist: the average distance of all point pairs considered for this estimate\rgamma: the actual sample variogram estimate\rdir.hor: the horizontal direction\rdir.ver: the vertical direction\rid: the combined id pair\rfor more information, read the help of gstat::variogram help page in R.\nSemivariance Calculation\rExperimental variogram will be created with Semivariance against distance. Process is explained is, first, the semivariance \\(\\gamma(h)\\) is computed for each distance bin \\(h\\). The formula is:\n\\[\r\\gamma(h) = \\frac{1}{2N(h)} \\sum_{i=1}^{N(h)} \\left( z(x_i) - z(x_i + h) \\right)^2\r\\]\nWhere:\n\\(N(h)\\): Number of point pairs in the distance bin \\(h\\).\r\\(z(x_i)\\): Observed value at location \\(x_i\\).\r\\(z(x_i + h)\\): Observed value at location \\(x_i + h\\).\rThis gives the average squared difference of observed values separated by \\(h\\).\nThe formula shown is for computing semivariance for a given lag or distance ℎ, but it is not directly tied to a specific variogram model such as spherical, exponential, or Gaussian. This formula is a general expression used to calculate experimental semivariance, which is then plotted as an experimental variogram Once the experimental variogram is computed, you can fit it with a specific theoretical variogram model, such as Spherical, Exponential, Gaussian, etc. To identify the specific model, you would calculate the semivariances using the given formula, plot them against distance h, and then choose the model that best fits the curve.\nThere is a very nice youtube video by YT@MiningGeologist explaing the computation semivariance using the above equation.\nplot(variogram_exp, main = \"Experimental Variogram\")\rFitting a Theoretical Model\rThis involves selecting a mathematical function (e.g., spherical, exponential, Gaussian) to approximate the experimental variogram. The goal is to create a theoretical variogram that can be used in kriging or other geostatistical methods. The output is a smooth, continuous variogram model that represents the spatial variability of the data.\n# Fit a variogram model\rvariogram_model \u003c- fit.variogram(variogram_exp, model = vgm(\"Sph\", range = 50, nugget = 2))\r# Plot the fitted model\rplot(variogram_exp, variogram_model, main = \"Fitted Variogram Model (Spherical)\")\rTrying Another Model\r# Fit a variogram model\rvariogram_model_exp \u003c- fit.variogram(variogram_exp, model = vgm(\"Exp\", nugget = 2))\r# Plot the fitted model\rplot(variogram_exp, variogram_model_exp, main = \"Fitted Variogram Model (Exponential)\")\rPerforming Kriging\rOnce we have a fitted variogram model, we can perform Kriging to interpolate water levels.\n# Generate a grid for interpolation\rgrid \u003c- expand.grid(\rx = seq(0, 100, by = 1),\ry = seq(0, 100, by = 1)\r)\rcoordinates(grid) \u003c- ~x + y\rgridded(grid) \u003c- TRUE\r# Perform Kriging\rkriging_result \u003c- krige(water_level ~ 1, location, grid, model = variogram_model)\r## [using ordinary kriging]\r# Visualize the results\rspplot(kriging_result[\"var1.pred\"], main = \"Kriging Interpolation\")\rConclusion\rVariograms are an essential tool in geospatial analysis, providing insights into spatial relationships and guiding interpolation techniques. By understanding and applying variogram concepts, we can make informed decisions in various fields, including hydrology, agriculture, and environmental monitoring.\n",
  "wordCount" : "1196",
  "inLanguage": "en",
  "image":"https://ankitdeshmukh.com/Cover.jpg","datePublished": "2025-01-17T00:00:00Z",
  "dateModified": "2025-01-17T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Dr. Ankit Deshmukh"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ankitdeshmukh.com/post/2025-01-17-variogram/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ankit's Hydro-Geo Insights",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ankitdeshmukh.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ankitdeshmukh.com/" accesskey="h" title="Ankit&#39;s Hydro-Geo Insight! (Alt + H)">
                <img src="https://ankitdeshmukh.com/Logo.png" alt="logo" aria-label="logo"
                    height="35">Ankit&#39;s Hydro-Geo Insight!</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ankitdeshmukh.com/post/" title="Blogs">
                    <span>Blogs</span>
                </a>
            </li>
            <li>
                <a href="https://ankitdeshmukh.com/research/" title="Research">
                    <span>Research</span>
                </a>
            </li>
            <li>
                <a href="https://ankitdeshmukh.com/slides/" title="Slides">
                    <span>Slides</span>
                </a>
            </li>
            <li>
                <a href="https://ankitdeshmukh.com/avocation/" title="Avocation">
                    <span>Avocation</span>
                </a>
            </li>
            <li>
                <a href="https://ankitdeshmukh.com/search/" title="🔎︎">
                    <span>🔎︎</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ankitdeshmukh.com/">Home</a>&nbsp;»&nbsp;<a href="https://ankitdeshmukh.com/post/">Posts</a></div>
    <h1 class="post-title">
      Understanding Variogram in Geospatial Analysis
    </h1>
    <div class="post-meta"><span title='2025-01-17 00:00:00 +0000 UTC'>January 17, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Dr. Ankit Deshmukh

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover_hu0a218f9377039d4c92611fb498fb4ebe_81059_360x0_resize_q75_box.jpg 360w ,https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover_hu0a218f9377039d4c92611fb498fb4ebe_81059_480x0_resize_q75_box.jpg 480w ,https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover_hu0a218f9377039d4c92611fb498fb4ebe_81059_720x0_resize_q75_box.jpg 720w ,https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover_hu0a218f9377039d4c92611fb498fb4ebe_81059_1080x0_resize_q75_box.jpg 1080w ,https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover.jpg 1414w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://ankitdeshmukh.com/post/2025-01-17-variogram/Cover.jpg" alt="Image of Variogram" 
            width="1414" height="313">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#" aria-label="Introduction">Introduction</a><ul>
                        
                <li>
                    <a href="#" aria-label="A Note on Spatial Relationships">A Note on Spatial Relationships</a></li></ul>
                </li>
                <li>
                    <a href="#" aria-label="What is a Variogram?">What is a Variogram?</a><ul>
                        
                <li>
                    <a href="#" aria-label="Key Components of a Variogram">Key Components of a Variogram</a></li>
                <li>
                    <a href="#" aria-label="Variogram Models">Variogram Models</a></li></ul>
                </li>
                <li>
                    <a href="#" aria-label="Computing the Variogram in R">Computing the Variogram in R</a><ul>
                        
                <li>
                    <a href="#" aria-label="Experimental Variogram">Experimental Variogram</a></li>
                <li>
                    <a href="#" aria-label="Semivariance Calculation">Semivariance Calculation</a></li>
                <li>
                    <a href="#" aria-label="Fitting a Theoretical Model">Fitting a Theoretical Model</a></li>
                <li>
                    <a href="#" aria-label="Trying Another Model">Trying Another Model</a></li></ul>
                </li>
                <li>
                    <a href="#" aria-label="Performing Kriging">Performing Kriging</a></li>
                <li>
                    <a href="#" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content">


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Geospatial analysis often involves understanding the spatial relationships between data points. One foundational concept in this domain is the <strong>variogram</strong>. In this article, we will explore what a variogram is, how it is used in <strong>Kriging</strong>, and how to compute experimental and semi-variograms for hypothetical borehole data. Finally, we will use these concepts to interpolate water levels across all data points using Kriging.</p>
<div id="a-note-on-spatial-relationships" class="section level3">
<h3>A Note on Spatial Relationships</h3>
<p>The First Law of Geography, proposed by Waldo Tobler, states:</p>
<blockquote>
<p>“Everything is related to everything else, but near things are more related than distant things.”</p>
</blockquote>
<p>This principle forms the backbone of variogram analysis and Kriging.</p>
</div>
</div>
<div id="what-is-a-variogram" class="section level2">
<h2>What is a Variogram?</h2>
<p>A variogram is a graphical representation or function that quantifies the spatial autocorrelation of a dataset. It demonstrates how similarity between measurements decreases with increasing distance.</p>
<div id="key-components-of-a-variogram" class="section level3">
<h3>Key Components of a Variogram</h3>
<ol style="list-style-type: decimal">
<li><strong>Lag Distance (h):</strong> The separation distance between data points.</li>
<li><strong>Semivariance (γ(h)):</strong> A measure of the dissimilarity between data points separated by distance <code>h</code>.</li>
<li><strong>Sill:</strong> The semivariance value where the variogram levels off, representing the data’s overall variance.</li>
<li><strong>Range:</strong> The distance at which the variogram reaches the sill, indicating the limit of spatial correlation.</li>
<li><strong>Nugget:</strong> The y-intercept of the variogram, accounting for measurement errors or microscale variations.</li>
</ol>
</div>
<div id="variogram-models" class="section level3">
<h3>Variogram Models</h3>
<p>Variogram models are mathematical functions used to fit experimental variograms. These models capture the spatial dependence of the data and are essential for Kriging. Commonly used models include:</p>
<ol style="list-style-type: decimal">
<li><strong>Spherical Model:</strong>
<ul>
<li><strong>Formula:</strong>
<span class="math display">\[
\gamma(h) =
\begin{cases}
C_0 + C \left[\frac{3h}{2a} - \frac{h^3}{2a^3}\right], &amp; 0 \leq h \leq a \\
C_0 + C, &amp; h &gt; a
\end{cases}
\]</span></li>
<li><strong>Characteristics:</strong>
<ul>
<li>Commonly used in geosciences.</li>
<li>Levels off at the range (<code>a</code>).</li>
<li>Represents a gradual transition of spatial correlation.</li>
</ul></li>
</ul></li>
<li><strong>Exponential Model:</strong>
<ul>
<li><strong>Formula:</strong>
<span class="math display">\[
\gamma(h) = C_0 + C \left(1 - e^{-h/a}\right)
\]</span></li>
<li><strong>Characteristics:</strong>
<ul>
<li>Suitable for phenomena with continuous but less abrupt changes.</li>
<li>Correlation decreases exponentially with distance.</li>
</ul></li>
</ul></li>
<li><strong>Gaussian Model:</strong>
<ul>
<li><strong>Formula:</strong>
<span class="math display">\[
\gamma(h) = C_0 + C \left(1 - e^{-\left(\frac{h}{a}\right)^2}\right)
\]</span></li>
<li><strong>Characteristics:</strong>
<ul>
<li>Smooth transitions, often used in environmental studies.</li>
<li>Effective for data with strong local correlations.</li>
</ul></li>
</ul></li>
<li><strong>Linear Model:</strong>
<ul>
<li><strong>Formula:</strong>
<span class="math display">\[
\gamma(h) = C_0 + C h
\]</span></li>
<li><strong>Characteristics:</strong>
<ul>
<li>Represents a direct, proportional increase in semivariance with distance.</li>
<li>Simplistic but useful for certain datasets.</li>
</ul></li>
</ul></li>
<li><strong>Power Model:</strong>
<ul>
<li><strong>Formula:</strong>
<span class="math display">\[
\gamma(h) = C_0 + C h^k, \quad 0 &lt; k &lt; 2
\]</span></li>
<li><strong>Characteristics:</strong>
<ul>
<li>Flexible model for datasets with non-linear spatial relationships.</li>
</ul></li>
</ul></li>
</ol>
<p>Each model serves specific purposes based on the dataset and the spatial behavior being analyzed. Selecting the appropriate variogram model is crucial for accurate Kriging.</p>
<p>The summary of selecting a variogram model presented below:</p>
<table>
<thead>
<tr>
<th><strong>Condition</strong></th>
<th><strong>Recommended Model</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Sharp cutoff in spatial correlation</td>
<td>Spherical (Sph)</td>
</tr>
<tr>
<td>Rapid decay of correlation</td>
<td>Exponential (Exp)</td>
</tr>
<tr>
<td>Smooth transitions over space</td>
<td>Gaussian (Gau)</td>
</tr>
<tr>
<td>Flexible/Intermediate behavior</td>
<td>Matérn (Mat)</td>
</tr>
<tr>
<td>Short-range dominance</td>
<td>Exponential or Matérn</td>
</tr>
<tr>
<td>Long-range dominance</td>
<td>Spherical or Gaussian</td>
</tr>
<tr>
<td>Uncertainty about smoothness</td>
<td>Matérn (adjust <span class="math inline">\(\nu\)</span>)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="computing-the-variogram-in-r" class="section level2">
<h2>Computing the Variogram in R</h2>
<p>Here, we demonstrate how to compute an experimental variogram and fit a theoretical model using hypothetical borehole data.</p>
<pre class="r"><code># Generate hypothetical borehole data
set.seed(123)
location &lt;- data.frame(
  x = runif(20, 0, 100),
  y = runif(20, 0, 100)
)
location$water_level &lt;- 50 + rnorm(20, mean = 0, sd = 5)

# View the data
head(location)</code></pre>
<pre><code>##          x        y water_level
## 1 28.75775 88.95393    44.66088
## 2 78.83051 69.28034    48.91013
## 3 40.89769 64.05068    44.86998
## 4 88.30174 99.42698    46.35554
## 5 94.04673 65.57058    46.87480
## 6  4.55565 70.85305    41.56653</code></pre>
<div id="experimental-variogram" class="section level3">
<h3>Experimental Variogram</h3>
<pre class="r"><code>if (!require(sp)) { install.packages(&#39;sp&#39;); library(sp)}
if (!require(gstat)) { install.packages(&#39;gstat&#39;); library(gstat)}

# Convert to spatial object
coordinates(location) &lt;- ~x + y

# Compute experimental variogram
variogram_exp &lt;- variogram(water_level ~ 1, location)
head(variogram_exp)</code></pre>
<pre><code>##   np      dist     gamma dir.hor dir.ver   id
## 1  2  7.912548 12.129825       0       0 var1
## 2  2 11.366795  9.534399       0       0 var1
## 3  2 14.046246 17.299652       0       0 var1
## 4  6 15.922439 23.613955       0       0 var1
## 5  4 19.786952 31.321265       0       0 var1
## 6  5 22.195585 18.261615       0       0 var1</code></pre>
<p>The formula used above have format <code>independent_variable ~ 1</code> or <code>independent_variable ~ x+y</code>. X or/and Y, any independent variables or covariates (if applicable). If the formula is ~ 1, it means there are no covariates, and the variogram will be calculated solely based on spatial relationships. The output of <code>variogram_exp</code> is has field such as np, dist, gamma etc…</p>
<ul>
<li>np: the number of point pairs for this estimate; in case of a variogramCloud see below</li>
<li>dist: the average distance of all point pairs considered for this estimate</li>
<li>gamma: the actual sample variogram estimate</li>
<li>dir.hor: the horizontal direction</li>
<li>dir.ver: the vertical direction</li>
<li>id: the combined id pair</li>
</ul>
<p>for more information, read the help of <code>gstat::variogram</code> help page in R.</p>
</div>
<div id="semivariance-calculation" class="section level3">
<h3>Semivariance Calculation</h3>
<p>Experimental variogram will be created with Semivariance against distance. Process is explained is, first, the semivariance <span class="math inline">\(\gamma(h)\)</span> is computed for each distance bin <span class="math inline">\(h\)</span>. The formula is:</p>
<p><span class="math display">\[
\gamma(h) = \frac{1}{2N(h)} \sum_{i=1}^{N(h)} \left( z(x_i) - z(x_i + h) \right)^2
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(N(h)\)</span>: Number of point pairs in the distance bin <span class="math inline">\(h\)</span>.</li>
<li><span class="math inline">\(z(x_i)\)</span>: Observed value at location <span class="math inline">\(x_i\)</span>.</li>
<li><span class="math inline">\(z(x_i + h)\)</span>: Observed value at location <span class="math inline">\(x_i + h\)</span>.</li>
</ul>
<p>This gives the average squared difference of observed values separated by <span class="math inline">\(h\)</span>.</p>
<p>The formula shown is for computing semivariance for a given lag or distance ℎ, but it is not directly tied to a specific variogram model such as spherical, exponential, or Gaussian. This formula is a general expression used to calculate experimental semivariance, which is then plotted as an experimental variogram Once the experimental variogram is computed, you can fit it with a specific theoretical variogram model, such as Spherical, Exponential, Gaussian, etc. To identify the specific model, you would calculate the semivariances using the given formula, plot them against distance h, and then choose the model that best fits the curve.</p>
<p>There is a very nice youtube video by <a href="https://www.youtube.com/@MiningGeologist">YT@MiningGeologist</a> explaing the computation semivariance using the above equation.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/hxkgL6VA_Nw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<pre class="r"><code>plot(variogram_exp, main = &quot;Experimental Variogram&quot;)</code></pre>
<p><img src="https://ankitdeshmukh.com/post/2025-01-17-variogram/index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="fitting-a-theoretical-model" class="section level3">
<h3>Fitting a Theoretical Model</h3>
<p>This involves selecting a mathematical function (e.g., spherical, exponential, Gaussian) to approximate the experimental variogram. The goal is to create a theoretical variogram that can be used in kriging or other geostatistical methods. The output is a smooth, continuous variogram model that represents the spatial variability of the data.</p>
<pre class="r"><code># Fit a variogram model
variogram_model &lt;- fit.variogram(variogram_exp, model = vgm(&quot;Sph&quot;, range = 50, nugget = 2))

# Plot the fitted model
plot(variogram_exp, variogram_model, main = &quot;Fitted Variogram Model (Spherical)&quot;)</code></pre>
<p><img src="https://ankitdeshmukh.com/post/2025-01-17-variogram/index_files/figure-html/variogram-modeling-1.png" width="672" /></p>
</div>
<div id="trying-another-model" class="section level3">
<h3>Trying Another Model</h3>
<pre class="r"><code># Fit a variogram model
variogram_model_exp &lt;- fit.variogram(variogram_exp, model = vgm(&quot;Exp&quot;, nugget = 2))

# Plot the fitted model
plot(variogram_exp, variogram_model_exp, main = &quot;Fitted Variogram Model (Exponential)&quot;)</code></pre>
<p><img src="https://ankitdeshmukh.com/post/2025-01-17-variogram/index_files/figure-html/variogram-modeling_exp-1.png" width="672" /></p>
</div>
</div>
<div id="performing-kriging" class="section level2">
<h2>Performing Kriging</h2>
<p>Once we have a fitted variogram model, we can perform Kriging to interpolate water levels.</p>
<pre class="r"><code># Generate a grid for interpolation
grid &lt;- expand.grid(
  x = seq(0, 100, by = 1),
  y = seq(0, 100, by = 1)
)
coordinates(grid) &lt;- ~x + y

gridded(grid) &lt;- TRUE

# Perform Kriging
kriging_result &lt;- krige(water_level ~ 1, location, grid, model = variogram_model)</code></pre>
<pre><code>## [using ordinary kriging]</code></pre>
<pre class="r"><code># Visualize the results
spplot(kriging_result[&quot;var1.pred&quot;], main = &quot;Kriging Interpolation&quot;)</code></pre>
<p><img src="https://ankitdeshmukh.com/post/2025-01-17-variogram/index_files/figure-html/kriging-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Variograms are an essential tool in geospatial analysis, providing insights into spatial relationships and guiding interpolation techniques. By understanding and applying variogram concepts, we can make informed decisions in various fields, including hydrology, agriculture, and environmental monitoring.</p>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ankitdeshmukh.com/tags/r/">R</a></li>
      <li><a href="https://ankitdeshmukh.com/tags/geospatial/">Geospatial</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ankitdeshmukh.com/post/2025-02-07-running-llm-locally-setting-up-deepseek-r1/">
    <span class="title">« Prev</span>
    <br>
    <span>Setting Up Local Large Language Models on Windows: Ollama, RAG, and Opne-webui</span>
  </a>
  <a class="next" href="https://ankitdeshmukh.com/post/2025-01-06-lst-lulc-computation-with-landsat/">
    <span class="title">Next »</span>
    <br>
    <span>Land surface change detection Landsat data</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Understanding Variogram in Geospatial Analysis on twitter"
        href="https://twitter.com/intent/tweet/?text=Understanding%20Variogram%20in%20Geospatial%20Analysis&amp;url=https%3a%2f%2fankitdeshmukh.com%2fpost%2f2025-01-17-variogram%2f&amp;hashtags=R%2cGeospatial">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Understanding Variogram in Geospatial Analysis on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fankitdeshmukh.com%2fpost%2f2025-01-17-variogram%2f&amp;title=Understanding%20Variogram%20in%20Geospatial%20Analysis&amp;summary=Understanding%20Variogram%20in%20Geospatial%20Analysis&amp;source=https%3a%2f%2fankitdeshmukh.com%2fpost%2f2025-01-17-variogram%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><style>
  .update-box {
    max-width: 500px;
    margin: 1rem auto;
    padding: 1rem;
    background: var(--entry);
    border-radius: 16px;
    border: 1px solid var(--border);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  }

  .update-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    color: var(--primary);
  }

  .update-icon {
    width: 1.2rem;
    height: 1.2rem;
    fill: currentColor;
  }

  .update-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0;
  }

  .update-content {
    font-size: 0.9rem;
    line-height: 1.4;
    color: var(--content);
  }

  .update-link {
    display: inline-block;
    margin-top: 0.25rem;
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    color: burlywood;
  }

  .update-link:hover {
    text-decoration: underline;
    color: rgb(82, 82, 221);
  }
</style>

<div class="update-box">
  <div class="update-header">
    <svg class="update-icon" viewBox="0 0 24 24">
      <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
    </svg>
    <h2 class="update-title">Website Updates!</h2>
  </div>
  <div class="update-content">
    <p>2025-03-26 | <br /> Published and online: A Sustainable Framework for Drought Modeling using Meteorological Drought Indicators as Proxies for Hydrological Drought</p>
    <a href="https://doi.org/10.1109/SETCOM64758.2025.10932368" class="update-link">Learn more →</a>
<br />  <br />
    <p>2025-03-26 | <br /> Published and online: Sustainable Modeling Framework for the Prediction in Ungauged Catchments: Leveraging Large-Sample Hydrology Datasets with Machine Learning</p>
    <a href="https://doi.org/10.1109/SETCOM64758.2025.10932500" class="update-link">Learn more →</a>
  </div>
</div>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
